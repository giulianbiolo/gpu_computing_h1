import matplotlib.pyplot as plt

GRAPH_OPT = 3 # 0 for -O0, 1 for -O1, 2 for -O2, 3 for -O3
GRAPH_EFF_BANDWIDTH_WITH_OPT_N = 4096 # 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096

data_O0 = {
    2 : { 'S': { 'MIN': 0.024, 'MAX': 0.131, 'MED': 0.029 }, 'B2': { 'MIN': 0.027, 'MAX': 0.123, 'MED': 0.031 } , },
    4 : { 'S': { 'MIN': 0.049, 'MAX': 0.093, 'MED': 0.052 }, 'B2': { 'MIN': 0.061, 'MAX': 0.111, 'MED': 0.064 } , 'B4': { 'MIN': 0.052, 'MAX': 0.101, 'MED': 0.056 } , },
    8 : { 'S': { 'MIN': 0.142, 'MAX': 0.224, 'MED': 0.151 }, 'B2': { 'MIN': 0.216, 'MAX': 0.286, 'MED': 0.222 } , 'B4': { 'MIN': 0.160, 'MAX': 0.250, 'MED': 0.170 } , 'B8': { 'MIN': 0.148, 'MAX': 0.234, 'MED': 0.157 } , },
    16 : { 'S': { 'MIN': 0.538, 'MAX': 0.625, 'MED': 0.555 }, 'B2': { 'MIN': 0.741, 'MAX': 0.830, 'MED': 0.754 } , 'B4': { 'MIN': 0.613, 'MAX': 0.719, 'MED': 0.622 } , 'B8': { 'MIN': 0.566, 'MAX': 0.657, 'MED': 0.578 } , 'B16': { 'MIN': 0.532, 'MAX': 0.622, 'MED': 0.556 } , },
    32 : { 'S': { 'MIN': 2.049, 'MAX': 2.176, 'MED': 2.102 }, 'B2': { 'MIN': 3.018, 'MAX': 3.107, 'MED': 3.034 } , 'B4': { 'MIN': 2.442, 'MAX': 18.994, 'MED': 2.794 } , 'B8': { 'MIN': 2.212, 'MAX': 2.417, 'MED': 2.238 } , 'B16': { 'MIN': 2.157, 'MAX': 2.292, 'MED': 2.184 } , 'B32': { 'MIN': 2.063, 'MAX': 14.329, 'MED': 2.347 } , },
    64 : { 'S': { 'MIN': 8.290, 'MAX': 22.193, 'MED': 9.280 }, 'B2': { 'MIN': 12.067, 'MAX': 26.270, 'MED': 13.456 } , 'B4': { 'MIN': 9.844, 'MAX': 22.216, 'MED': 10.768 } , 'B8': { 'MIN': 9.044, 'MAX': 21.683, 'MED': 9.570 } , 'B16': { 'MIN': 9.045, 'MAX': 10.648, 'MED': 9.494 } , 'B32': { 'MIN': 8.819, 'MAX': 10.135, 'MED': 9.175 } , 'B64': { 'MIN': 9.103, 'MAX': 9.938, 'MED': 9.343 } , },
    128 : { 'S': { 'MIN': 36.820, 'MAX': 44.223, 'MED': 37.893 }, 'B2': { 'MIN': 49.947, 'MAX': 61.595, 'MED': 51.024 } , 'B4': { 'MIN': 39.299, 'MAX': 56.221, 'MED': 41.520 } , 'B8': { 'MIN': 36.157, 'MAX': 55.657, 'MED': 38.390 } , 'B16': { 'MIN': 35.741, 'MAX': 74.785, 'MED': 39.100 } , 'B32': { 'MIN': 35.353, 'MAX': 61.599, 'MED': 37.769 } , 'B64': { 'MIN': 36.823, 'MAX': 64.791, 'MED': 39.582 } , 'B128': { 'MIN': 35.851, 'MAX': 40.432, 'MED': 36.806 } , },
    256 : { 'S': { 'MIN': 164.969, 'MAX': 212.898, 'MED': 179.090 }, 'B2': { 'MIN': 197.088, 'MAX': 255.782, 'MED': 208.260 } , 'B4': { 'MIN': 162.694, 'MAX': 224.264, 'MED': 171.895 } , 'B8': { 'MIN': 145.563, 'MAX': 213.929, 'MED': 152.790 } , 'B16': { 'MIN': 146.991, 'MAX': 179.186, 'MED': 153.961 } , 'B32': { 'MIN': 150.556, 'MAX': 199.632, 'MED': 158.190 } , 'B64': { 'MIN': 164.251, 'MAX': 240.353, 'MED': 174.796 } , 'B128': { 'MIN': 170.199, 'MAX': 242.289, 'MED': 178.898 } , },
    512 : { 'S': { 'MIN': 1462.306, 'MAX': 1736.860, 'MED': 1549.991 }, 'B2': { 'MIN': 946.495, 'MAX': 1197.046, 'MED': 1026.633 } , 'B4': { 'MIN': 782.198, 'MAX': 874.341, 'MED': 826.388 } , 'B8': { 'MIN': 607.828, 'MAX': 700.149, 'MED': 636.948 } , 'B16': { 'MIN': 628.387, 'MAX': 735.684, 'MED': 660.829 } , 'B32': { 'MIN': 631.937, 'MAX': 716.081, 'MED': 655.926 } , 'B64': { 'MIN': 698.870, 'MAX': 940.751, 'MED': 755.829 } , 'B128': { 'MIN': 696.773, 'MAX': 805.295, 'MED': 731.841 } , },
    1024 : { 'S': { 'MIN': 7096.067, 'MAX': 7695.450, 'MED': 7239.734 }, 'B2': { 'MIN': 4672.608, 'MAX': 5064.768, 'MED': 4778.581 } , 'B4': { 'MIN': 3757.812, 'MAX': 4209.794, 'MED': 3910.793 } , 'B8': { 'MIN': 2981.875, 'MAX': 3192.734, 'MED': 3071.310 } , 'B16': { 'MIN': 2958.272, 'MAX': 3302.108, 'MED': 3058.177 } , 'B32': { 'MIN': 3215.809, 'MAX': 3581.857, 'MED': 3321.058 } , 'B64': { 'MIN': 3408.029, 'MAX': 3708.935, 'MED': 3511.103 } , 'B128': { 'MIN': 3331.411, 'MAX': 3639.407, 'MED': 3437.824 } , },
    2048 : { 'S': { 'MIN': 41313.984, 'MAX': 44308.945, 'MED': 42519.391 }, 'B2': { 'MIN': 26028.248, 'MAX': 28164.264, 'MED': 27037.160 } , 'B4': { 'MIN': 18223.072, 'MAX': 19372.664, 'MED': 18764.246 } , 'B8': { 'MIN': 13237.811, 'MAX': 14299.166, 'MED': 13610.177 } , 'B16': { 'MIN': 12549.618, 'MAX': 13411.134, 'MED': 12873.545 } , 'B32': { 'MIN': 12960.944, 'MAX': 14503.040, 'MED': 13324.869 } , 'B64': { 'MIN': 13641.333, 'MAX': 14574.685, 'MED': 14011.867 } , 'B128': { 'MIN': 13497.986, 'MAX': 14455.449, 'MED': 13864.434 } , },
    4096 : { 'S': { 'MIN': 184696.469, 'MAX': 193158.375, 'MED': 188154.734 }, 'B2': { 'MIN': 114342.062, 'MAX': 119696.453, 'MED': 115923.773 } , 'B4': { 'MIN': 77206.883, 'MAX': 83381.234, 'MED': 79439.445 } , 'B8': { 'MIN': 56162.215, 'MAX': 58384.336, 'MED': 57444.945 } , 'B16': { 'MIN': 51425.977, 'MAX': 55339.137, 'MED': 52725.555 } , 'B32': { 'MIN': 52664.934, 'MAX': 55070.496, 'MED': 54103.930 } , 'B64': { 'MIN': 55414.664, 'MAX': 57548.504, 'MED': 56853.590 } , 'B128': { 'MIN': 54760.996, 'MAX': 58783.207, 'MED': 56160.684 } , },
}


data_O1 = {
    2 : { 'S': { 'MIN': 0.024, 'MAX': 0.146, 'MED': 0.028 }, 'B2': { 'MIN': 0.028, 'MAX': 0.115, 'MED': 0.031 } , },
    4 : { 'S': { 'MIN': 0.049, 'MAX': 0.096, 'MED': 0.052 }, 'B2': { 'MIN': 0.061, 'MAX': 0.132, 'MED': 0.064 } , 'B4': { 'MIN': 0.052, 'MAX': 0.112, 'MED': 0.056 } , },
    8 : { 'S': { 'MIN': 0.143, 'MAX': 0.204, 'MED': 0.155 }, 'B2': { 'MIN': 0.220, 'MAX': 0.307, 'MED': 0.231 } , 'B4': { 'MIN': 0.165, 'MAX': 12.274, 'MED': 0.418 } , 'B8': { 'MIN': 0.152, 'MAX': 0.240, 'MED': 0.161 } , },
    16 : { 'S': { 'MIN': 0.551, 'MAX': 0.639, 'MED': 0.560 }, 'B2': { 'MIN': 0.761, 'MAX': 0.848, 'MED': 0.770 } , 'B4': { 'MIN': 0.628, 'MAX': 0.785, 'MED': 0.640 } , 'B8': { 'MIN': 0.578, 'MAX': 0.701, 'MED': 0.591 } , 'B16': { 'MIN': 0.547, 'MAX': 0.602, 'MED': 0.570 } , },
    32 : { 'S': { 'MIN': 2.100, 'MAX': 2.155, 'MED': 2.114 }, 'B2': { 'MIN': 3.087, 'MAX': 3.196, 'MED': 3.109 } , 'B4': { 'MIN': 2.439, 'MAX': 2.640, 'MED': 2.508 } , 'B8': { 'MIN': 2.214, 'MAX': 2.368, 'MED': 2.229 } , 'B16': { 'MIN': 2.137, 'MAX': 2.273, 'MED': 2.184 } , 'B32': { 'MIN': 2.056, 'MAX': 2.234, 'MED': 2.096 } , },
    64 : { 'S': { 'MIN': 8.173, 'MAX': 21.894, 'MED': 9.343 }, 'B2': { 'MIN': 11.957, 'MAX': 26.466, 'MED': 12.460 } , 'B4': { 'MIN': 9.727, 'MAX': 22.117, 'MED': 10.236 } , 'B8': { 'MIN': 8.944, 'MAX': 23.093, 'MED': 9.762 } , 'B16': { 'MIN': 8.899, 'MAX': 10.454, 'MED': 9.368 } , 'B32': { 'MIN': 8.680, 'MAX': 10.354, 'MED': 9.073 } , 'B64': { 'MIN': 8.804, 'MAX': 9.803, 'MED': 8.989 } , },
    128 : { 'S': { 'MIN': 36.018, 'MAX': 52.293, 'MED': 37.970 }, 'B2': { 'MIN': 49.015, 'MAX': 76.409, 'MED': 52.271 } , 'B4': { 'MIN': 39.572, 'MAX': 65.392, 'MED': 41.080 } , 'B8': { 'MIN': 36.080, 'MAX': 77.300, 'MED': 38.852 } , 'B16': { 'MIN': 36.297, 'MAX': 50.290, 'MED': 37.917 } , 'B32': { 'MIN': 36.356, 'MAX': 37.786, 'MED': 36.832 } , 'B64': { 'MIN': 37.967, 'MAX': 43.496, 'MED': 38.714 } , 'B128': { 'MIN': 36.529, 'MAX': 50.397, 'MED': 37.899 } , },
    256 : { 'S': { 'MIN': 167.947, 'MAX': 223.978, 'MED': 179.187 }, 'B2': { 'MIN': 197.213, 'MAX': 242.842, 'MED': 205.938 } , 'B4': { 'MIN': 162.544, 'MAX': 204.570, 'MED': 171.246 } , 'B8': { 'MIN': 145.468, 'MAX': 213.321, 'MED': 151.752 } , 'B16': { 'MIN': 146.313, 'MAX': 190.492, 'MED': 149.584 } , 'B32': { 'MIN': 150.154, 'MAX': 216.724, 'MED': 157.669 } , 'B64': { 'MIN': 164.849, 'MAX': 223.162, 'MED': 173.305 } , 'B128': { 'MIN': 170.089, 'MAX': 231.999, 'MED': 177.461 } , },
    512 : { 'S': { 'MIN': 1455.699, 'MAX': 1697.433, 'MED': 1554.607 }, 'B2': { 'MIN': 956.207, 'MAX': 1148.470, 'MED': 1029.211 } , 'B4': { 'MIN': 781.829, 'MAX': 880.881, 'MED': 806.154 } , 'B8': { 'MIN': 607.402, 'MAX': 706.288, 'MED': 633.021 } , 'B16': { 'MIN': 630.268, 'MAX': 1987.716, 'MED': 688.361 } , 'B32': { 'MIN': 631.326, 'MAX': 714.633, 'MED': 657.687 } , 'B64': { 'MIN': 700.952, 'MAX': 983.615, 'MED': 745.628 } , 'B128': { 'MIN': 696.196, 'MAX': 875.891, 'MED': 729.753 } , },
    1024 : { 'S': { 'MIN': 6882.714, 'MAX': 7724.568, 'MED': 7131.431 }, 'B2': { 'MIN': 4557.252, 'MAX': 5160.332, 'MED': 4723.373 } , 'B4': { 'MIN': 3742.671, 'MAX': 4013.378, 'MED': 3861.186 } , 'B8': { 'MIN': 2941.861, 'MAX': 3539.144, 'MED': 3052.054 } , 'B16': { 'MIN': 2959.250, 'MAX': 3161.823, 'MED': 3043.058 } , 'B32': { 'MIN': 3178.181, 'MAX': 3403.646, 'MED': 3284.469 } , 'B64': { 'MIN': 3332.051, 'MAX': 3542.076, 'MED': 3454.900 } , 'B128': { 'MIN': 3286.142, 'MAX': 3544.119, 'MED': 3408.573 } , },
    2048 : { 'S': { 'MIN': 40733.535, 'MAX': 43277.535, 'MED': 41829.547 }, 'B2': { 'MIN': 25450.447, 'MAX': 26907.752, 'MED': 26178.102 } , 'B4': { 'MIN': 18178.801, 'MAX': 18802.180, 'MED': 18595.984 } , 'B8': { 'MIN': 13223.858, 'MAX': 13843.538, 'MED': 13543.486 } , 'B16': { 'MIN': 12526.732, 'MAX': 13387.502, 'MED': 12867.821 } , 'B32': { 'MIN': 12881.889, 'MAX': 13430.595, 'MED': 13182.413 } , 'B64': { 'MIN': 13460.632, 'MAX': 15068.389, 'MED': 13827.249 } , 'B128': { 'MIN': 13282.048, 'MAX': 13848.239, 'MED': 13586.101 } , },
    4096 : { 'S': { 'MIN': 183499.594, 'MAX': 188706.812, 'MED': 187031.625 }, 'B2': { 'MIN': 112145.781, 'MAX': 116567.508, 'MED': 114730.188 } , 'B4': { 'MIN': 76966.438, 'MAX': 80753.758, 'MED': 78739.078 } , 'B8': { 'MIN': 55811.293, 'MAX': 62522.930, 'MED': 57086.199 } , 'B16': { 'MIN': 51189.203, 'MAX': 57966.312, 'MED': 52496.328 } , 'B32': { 'MIN': 52550.160, 'MAX': 56077.555, 'MED': 53823.168 } , 'B64': { 'MIN': 54523.551, 'MAX': 58339.512, 'MED': 55798.992 } , 'B128': { 'MIN': 53885.207, 'MAX': 67120.047, 'MED': 57392.547 } , },
}

data_O2 = {
    2 : { 'S': { 'MIN': 0.024, 'MAX': 0.125, 'MED': 0.028 }, 'B2': { 'MIN': 0.027, 'MAX': 0.098, 'MED': 0.030 } , },
    4 : { 'S': { 'MIN': 0.049, 'MAX': 0.124, 'MED': 0.055 }, 'B2': { 'MIN': 0.059, 'MAX': 0.201, 'MED': 0.066 } , 'B4': { 'MIN': 0.051, 'MAX': 13.882, 'MED': 0.332 } , },
    8 : { 'S': { 'MIN': 0.143, 'MAX': 12.117, 'MED': 0.393 }, 'B2': { 'MIN': 0.222, 'MAX': 0.313, 'MED': 0.229 } , 'B4': { 'MIN': 0.164, 'MAX': 0.247, 'MED': 0.173 } , 'B8': { 'MIN': 0.151, 'MAX': 0.230, 'MED': 0.158 } , },
    16 : { 'S': { 'MIN': 0.537, 'MAX': 12.683, 'MED': 0.798 }, 'B2': { 'MIN': 0.740, 'MAX': 0.822, 'MED': 0.749 } , 'B4': { 'MIN': 0.609, 'MAX': 0.760, 'MED': 0.620 } , 'B8': { 'MIN': 0.565, 'MAX': 0.681, 'MED': 0.579 } , 'B16': { 'MIN': 0.539, 'MAX': 0.630, 'MED': 0.563 } , },
    32 : { 'S': { 'MIN': 2.049, 'MAX': 2.146, 'MED': 2.093 }, 'B2': { 'MIN': 3.010, 'MAX': 3.160, 'MED': 3.054 } , 'B4': { 'MIN': 2.441, 'MAX': 18.667, 'MED': 3.569 } , 'B8': { 'MIN': 2.212, 'MAX': 2.389, 'MED': 2.253 } , 'B16': { 'MIN': 2.145, 'MAX': 17.460, 'MED': 2.495 } , 'B32': { 'MIN': 2.062, 'MAX': 2.176, 'MED': 2.103 } , },
    64 : { 'S': { 'MIN': 8.304, 'MAX': 22.039, 'MED': 9.348 }, 'B2': { 'MIN': 12.191, 'MAX': 68.952, 'MED': 13.697 } , 'B4': { 'MIN': 9.841, 'MAX': 10.904, 'MED': 10.325 } , 'B8': { 'MIN': 9.168, 'MAX': 19.077, 'MED': 9.593 } , 'B16': { 'MIN': 9.149, 'MAX': 10.416, 'MED': 9.564 } , 'B32': { 'MIN': 8.927, 'MAX': 17.051, 'MED': 9.502 } , 'B64': { 'MIN': 9.213, 'MAX': 10.030, 'MED': 9.445 } , },
    128 : { 'S': { 'MIN': 36.687, 'MAX': 47.328, 'MED': 38.381 }, 'B2': { 'MIN': 49.904, 'MAX': 76.348, 'MED': 52.324 } , 'B4': { 'MIN': 40.277, 'MAX': 52.075, 'MED': 40.979 } , 'B8': { 'MIN': 37.077, 'MAX': 44.291, 'MED': 37.501 } , 'B16': { 'MIN': 35.954, 'MAX': 39.183, 'MED': 36.902 } , 'B32': { 'MIN': 34.879, 'MAX': 65.766, 'MED': 36.618 } , 'B64': { 'MIN': 36.247, 'MAX': 54.873, 'MED': 37.639 } , 'B128': { 'MIN': 35.567, 'MAX': 76.594, 'MED': 37.589 } , },
    256 : { 'S': { 'MIN': 163.965, 'MAX': 236.004, 'MED': 177.977 }, 'B2': { 'MIN': 196.408, 'MAX': 238.542, 'MED': 204.928 } , 'B4': { 'MIN': 162.216, 'MAX': 218.773, 'MED': 170.560 } , 'B8': { 'MIN': 145.026, 'MAX': 227.210, 'MED': 155.359 } , 'B16': { 'MIN': 146.137, 'MAX': 208.554, 'MED': 155.118 } , 'B32': { 'MIN': 149.347, 'MAX': 203.240, 'MED': 156.812 } , 'B64': { 'MIN': 163.965, 'MAX': 224.575, 'MED': 174.996 } , 'B128': { 'MIN': 169.294, 'MAX': 228.631, 'MED': 179.165 } , },
    512 : { 'S': { 'MIN': 1462.122, 'MAX': 1795.910, 'MED': 1569.675 }, 'B2': { 'MIN': 961.940, 'MAX': 1138.232, 'MED': 1028.044 } , 'B4': { 'MIN': 777.663, 'MAX': 924.929, 'MED': 818.225 } , 'B8': { 'MIN': 607.354, 'MAX': 694.273, 'MED': 636.594 } , 'B16': { 'MIN': 629.972, 'MAX': 735.434, 'MED': 668.744 } , 'B32': { 'MIN': 631.486, 'MAX': 915.875, 'MED': 678.290 } , 'B64': { 'MIN': 696.999, 'MAX': 851.831, 'MED': 750.329 } , 'B128': { 'MIN': 690.601, 'MAX': 830.053, 'MED': 732.103 } , },
    1024 : { 'S': { 'MIN': 7034.857, 'MAX': 7588.919, 'MED': 7198.889 }, 'B2': { 'MIN': 4537.022, 'MAX': 4951.714, 'MED': 4696.560 } , 'B4': { 'MIN': 3809.344, 'MAX': 4092.254, 'MED': 3899.682 } , 'B8': { 'MIN': 2937.791, 'MAX': 3239.685, 'MED': 3061.137 } , 'B16': { 'MIN': 2958.125, 'MAX': 3239.824, 'MED': 3090.101 } , 'B32': { 'MIN': 3198.986, 'MAX': 3512.468, 'MED': 3327.421 } , 'B64': { 'MIN': 3317.901, 'MAX': 3736.654, 'MED': 3422.771 } , 'B128': { 'MIN': 3287.555, 'MAX': 3559.972, 'MED': 3394.595 } , },
    2048 : { 'S': { 'MIN': 40589.137, 'MAX': 43301.000, 'MED': 42215.738 }, 'B2': { 'MIN': 25577.305, 'MAX': 27502.877, 'MED': 26444.488 } , 'B4': { 'MIN': 18142.361, 'MAX': 19581.414, 'MED': 18647.053 } , 'B8': { 'MIN': 13253.931, 'MAX': 14170.615, 'MED': 13664.921 } , 'B16': { 'MIN': 12541.021, 'MAX': 13716.966, 'MED': 12874.975 } , 'B32': { 'MIN': 12966.131, 'MAX': 13849.424, 'MED': 13329.984 } , 'B64': { 'MIN': 13441.800, 'MAX': 14293.607, 'MED': 13800.624 } , 'B128': { 'MIN': 13263.269, 'MAX': 14003.010, 'MED': 13622.052 } , },
    4096 : { 'S': { 'MIN': 183254.922, 'MAX': 189292.891, 'MED': 186967.906 }, 'B2': { 'MIN': 112218.133, 'MAX': 115770.922, 'MED': 114384.617 } , 'B4': { 'MIN': 76859.094, 'MAX': 81230.172, 'MED': 78386.953 } , 'B8': { 'MIN': 55720.855, 'MAX': 58117.352, 'MED': 56962.133 } , 'B16': { 'MIN': 51208.664, 'MAX': 53536.070, 'MED': 52294.105 } , 'B32': { 'MIN': 52722.898, 'MAX': 56848.051, 'MED': 53861.988 } , 'B64': { 'MIN': 54408.566, 'MAX': 57496.469, 'MED': 55825.273 } , 'B128': { 'MIN': 53795.223, 'MAX': 56158.680, 'MED': 54954.992 } , },
}

data_O3 = {
    2 : { 'S': { 'MIN': 0.024, 'MAX': 0.101, 'MED': 0.029 }, 'B2': { 'MIN': 0.028, 'MAX': 0.107, 'MED': 0.031 } , },
    4 : { 'S': { 'MIN': 0.050, 'MAX': 0.119, 'MED': 0.055 }, 'B2': { 'MIN': 0.062, 'MAX': 0.147, 'MED': 0.068 } , 'B4': { 'MIN': 0.054, 'MAX': 0.104, 'MED': 0.060 } , },
    8 : { 'S': { 'MIN': 0.147, 'MAX': 0.260, 'MED': 0.154 }, 'B2': { 'MIN': 0.222, 'MAX': 0.311, 'MED': 0.229 } , 'B4': { 'MIN': 0.165, 'MAX': 0.265, 'MED': 0.174 } , 'B8': { 'MIN': 0.152, 'MAX': 0.223, 'MED': 0.159 } , },
    16 : { 'S': { 'MIN': 0.547, 'MAX': 0.654, 'MED': 0.558 }, 'B2': { 'MIN': 0.757, 'MAX': 0.895, 'MED': 0.769 } , 'B4': { 'MIN': 0.626, 'MAX': 0.764, 'MED': 0.636 } , 'B8': { 'MIN': 0.580, 'MAX': 0.707, 'MED': 0.593 } , 'B16': { 'MIN': 0.544, 'MAX': 0.662, 'MED': 0.569 } , },
    32 : { 'S': { 'MIN': 2.098, 'MAX': 2.271, 'MED': 2.124 }, 'B2': { 'MIN': 3.016, 'MAX': 17.040, 'MED': 3.390 } , 'B4': { 'MIN': 2.502, 'MAX': 9.512, 'MED': 2.730 } , 'B8': { 'MIN': 2.203, 'MAX': 2.683, 'MED': 2.289 } , 'B16': { 'MIN': 2.115, 'MAX': 2.417, 'MED': 2.249 } , 'B32': { 'MIN': 2.007, 'MAX': 2.135, 'MED': 2.045 } , },
    64 : { 'S': { 'MIN': 7.982, 'MAX': 22.104, 'MED': 9.916 }, 'B2': { 'MIN': 11.673, 'MAX': 38.561, 'MED': 13.498 } , 'B4': { 'MIN': 9.719, 'MAX': 26.515, 'MED': 10.313 } , 'B8': { 'MIN': 8.906, 'MAX': 9.994, 'MED': 9.258 } , 'B16': { 'MIN': 8.690, 'MAX': 23.337, 'MED': 9.430 } , 'B32': { 'MIN': 8.502, 'MAX': 21.061, 'MED': 9.113 } , 'B64': { 'MIN': 9.083, 'MAX': 17.536, 'MED': 9.682 } , },
    128 : { 'S': { 'MIN': 36.302, 'MAX': 45.416, 'MED': 37.589 }, 'B2': { 'MIN': 49.914, 'MAX': 72.060, 'MED': 51.790 } , 'B4': { 'MIN': 40.273, 'MAX': 44.474, 'MED': 40.634 } , 'B8': { 'MIN': 36.830, 'MAX': 42.241, 'MED': 37.318 } , 'B16': { 'MIN': 35.638, 'MAX': 59.814, 'MED': 36.879 } , 'B32': { 'MIN': 35.192, 'MAX': 46.081, 'MED': 35.784 } , 'B64': { 'MIN': 35.967, 'MAX': 62.741, 'MED': 37.352 } , 'B128': { 'MIN': 35.180, 'MAX': 62.591, 'MED': 36.935 } , },
    256 : { 'S': { 'MIN': 164.753, 'MAX': 220.582, 'MED': 184.055 }, 'B2': { 'MIN': 196.975, 'MAX': 232.115, 'MED': 203.879 } , 'B4': { 'MIN': 162.521, 'MAX': 196.176, 'MED': 169.088 } , 'B8': { 'MIN': 145.291, 'MAX': 193.800, 'MED': 153.341 } , 'B16': { 'MIN': 146.415, 'MAX': 186.794, 'MED': 154.215 } , 'B32': { 'MIN': 150.460, 'MAX': 197.571, 'MED': 159.298 } , 'B64': { 'MIN': 164.508, 'MAX': 222.264, 'MED': 169.602 } , 'B128': { 'MIN': 169.468, 'MAX': 214.997, 'MED': 175.909 } , },
    512 : { 'S': { 'MIN': 1470.959, 'MAX': 1690.107, 'MED': 1562.178 }, 'B2': { 'MIN': 938.400, 'MAX': 1141.409, 'MED': 1019.063 } , 'B4': { 'MIN': 785.116, 'MAX': 895.010, 'MED': 817.817 } , 'B8': { 'MIN': 609.911, 'MAX': 688.573, 'MED': 638.820 } , 'B16': { 'MIN': 631.430, 'MAX': 790.134, 'MED': 674.643 } , 'B32': { 'MIN': 638.138, 'MAX': 758.809, 'MED': 672.732 } , 'B64': { 'MIN': 701.164, 'MAX': 939.402, 'MED': 738.001 } , 'B128': { 'MIN': 695.180, 'MAX': 795.332, 'MED': 726.101 } , },
    1024 : { 'S': { 'MIN': 6961.578, 'MAX': 7502.349, 'MED': 7173.737 }, 'B2': { 'MIN': 4579.180, 'MAX': 4924.381, 'MED': 4750.725 } , 'B4': { 'MIN': 3839.058, 'MAX': 3988.243, 'MED': 3906.260 } , 'B8': { 'MIN': 2972.140, 'MAX': 3184.396, 'MED': 3063.603 } , 'B16': { 'MIN': 3037.826, 'MAX': 3351.076, 'MED': 3102.458 } , 'B32': { 'MIN': 3263.895, 'MAX': 3572.938, 'MED': 3359.438 } , 'B64': { 'MIN': 3374.476, 'MAX': 3759.415, 'MED': 3514.664 } , 'B128': { 'MIN': 3404.405, 'MAX': 3959.740, 'MED': 3487.308 } , },
    2048 : { 'S': { 'MIN': 40961.270, 'MAX': 43136.363, 'MED': 42399.605 }, 'B2': { 'MIN': 25846.928, 'MAX': 27328.650, 'MED': 26687.031 } , 'B4': { 'MIN': 18261.680, 'MAX': 19288.256, 'MED': 18724.969 } , 'B8': { 'MIN': 13229.818, 'MAX': 14134.935, 'MED': 13596.563 } , 'B16': { 'MIN': 12789.015, 'MAX': 13909.039, 'MED': 13018.304 } , 'B32': { 'MIN': 13001.958, 'MAX': 13610.793, 'MED': 13361.527 } , 'B64': { 'MIN': 13615.109, 'MAX': 14193.332, 'MED': 13992.917 } , 'B128': { 'MIN': 13487.744, 'MAX': 14115.506, 'MED': 13849.534 } , },
    4096 : { 'S': { 'MIN': 184118.281, 'MAX': 190408.281, 'MED': 188688.500 }, 'B2': { 'MIN': 113691.602, 'MAX': 116854.000, 'MED': 115953.562 } , 'B4': { 'MIN': 77618.859, 'MAX': 83850.930, 'MED': 79450.961 } , 'B8': { 'MIN': 56118.254, 'MAX': 60626.031, 'MED': 57543.172 } , 'B16': { 'MIN': 51568.027, 'MAX': 53992.641, 'MED': 52886.246 } , 'B32': { 'MIN': 53560.301, 'MAX': 55674.406, 'MED': 54421.328 } , 'B64': { 'MIN': 55628.703, 'MAX': 60993.828, 'MED': 57433.867 } , 'B128': { 'MIN': 54700.711, 'MAX': 56703.398, 'MED': 56066.477 } , },
}

B_values = ['S', 'B2', 'B4', 'B8', 'B16', 'B32', 'B64', 'B128']

plt.figure(figsize=(10, 6))

datas = [data_O0, data_O1, data_O2, data_O3]

for N, benchmarks in datas[GRAPH_OPT].items():
    times = [benchmarks.get(B, None) for B in B_values]
    median_times = [time['MED'] for time in times if time is not None]
    errorbar = [(time['MAX'] - time['MIN']) / 2 for time in times if time is not None]

    print("#" * 10)
    print(f"Now plotting for N={N}")
    print(median_times)
    print(errorbar)

    plt.plot(B_values[:len(median_times)], median_times, marker='none', label=f'N={N}', alpha=0.5)
    plt.errorbar(B_values[:len(median_times)], median_times, yerr=errorbar, fmt='none', elinewidth=2, alpha=0.8)

plt.xlabel('Block Size')
plt.ylabel('Time (microseconds)')
plt.title('Benchmark times for various Matrix Sizes and Block Sizes')
plt.grid(True)
plt.legend()
plt.savefig('benchmark.png')
plt.show()

# Plot the X: Matrix Size (N), Y: Time (microseconds) for each Optimization Level
datas = [data_O0, data_O1, data_O2, data_O3]

plt.figure(figsize=(10, 6))
for i, data in enumerate(datas):
    N_values = list(data.keys())
    N_values = N_values[4:12]   # ! Stop at 2^6 = 64 for clearness, above that the graph gets too cluttered no matter the scale of the X or Y axis
    print("N: ", N_values)
    # We don't plot the time, instead we plot the throughput of GB/s of moved memory
    # N * N * 8 bytes (double precision) / time (microseconds) = N * N * 8 / time
    throughput = [2 * (N * N * 8) / (data[N].get('B32')['MIN'] * 1000) for N in N_values] # ? In GB/s
    N_values = [str(N) for N in N_values]
    print("#" * 10)
    print(f"Now plotting for Optimization Level {i}")
    print(throughput)

    plt.plot(N_values, throughput, marker='o', label=f'Optimization Level {i}', alpha=0.5)

plt.xlabel('Matrix Size (N)')
plt.ylabel('Throughput (GB/s)')
plt.title('Throughput for various Matrix Sizes and Optimization Levels at set Block Size (32)')
plt.grid(True)
plt.legend()
plt.savefig('throughput_max_b32.png')
plt.show()

# Now plot only the GRAPH_EFF_BANDWIDTH_WITH_OPT_N lines from each data array

plt.figure(figsize=(10, 6))

N_O0 = data_O0[GRAPH_EFF_BANDWIDTH_WITH_OPT_N]
N_O1 = data_O1[GRAPH_EFF_BANDWIDTH_WITH_OPT_N]
N_O2 = data_O2[GRAPH_EFF_BANDWIDTH_WITH_OPT_N]
N_O3 = data_O3[GRAPH_EFF_BANDWIDTH_WITH_OPT_N]

for i, (N, label) in enumerate([(N_O0, 'O0'), (N_O1, 'O1'), (N_O2, 'O2'), (N_O3, 'O3')]):
    times = [N.get(B, None) for B in B_values]
    median_times = [time['MED'] for time in times if time is not None]
    errorbar = [(time['MAX'] - time['MIN']) / 2 for time in times if time is not None]

    print("#" * 10)
    print(f"Now plotting for {label}")
    print(median_times)
    print(errorbar)

    plt.plot(B_values[:len(median_times)], median_times, marker='none', label=f'{label}', alpha=0.5)
    plt.errorbar(B_values[:len(median_times)], median_times, yerr=errorbar, fmt='none', elinewidth=2, alpha=0.8)


plt.xlabel('Block Size')
plt.ylabel('Time (microseconds)')
plt.title(f'Benchmark times for N={GRAPH_EFF_BANDWIDTH_WITH_OPT_N} and various Optimization Levels')
plt.grid(True)
plt.legend()
plt.savefig('benchmark3.png')
plt.show()
